@extends('layouts.dashboard')

@section('title', __('app.emploi_du_temps'))

@section('breadcrumb')
    <li class="breadcrumb-item">{{ __('app.gestion_academique') }}</li>
    <li class="breadcrumb-item"><a href="{{ route('cours.index') }}">{{ __('app.cours') }}</a></li>
    <li class="breadcrumb-item active">{{ __('app.emploi_du_temps') }}</li>
@endsection

@section('header-actions')
    <div class="d-flex gap-2">
        <a href="{{ route('cours.index') }}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-1"></i>
            {{ __('app.retour') }}
        </a>
        @admin
            <a href="{{ route('cours.create') }}" class="btn btn-primary">
                <i class="bi bi-plus-circle me-1"></i>
                {{ __('app.ajouter_cours') }}
            </a>
        @endadmin
    </div>
@endsection

@section('content')
<div class="container-fluid">
    <!-- Header Card -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h4 class="mb-1 fw-bold">{{ __('app.emploi_du_temps') }}</h4>
                    <p class="text-muted small mb-0">{{ __('app.consulter_emploi_temps') }}</p>
                </div>
                <div class="col-md-4">
                    <label class="form-label small text-muted mb-1">{{ __('app.selectionner_classe') }}</label>
                    <select id="classSelect" class="form-select">
                        @foreach ($classe as $class)
                            <option value="classe{{ $class->id_classe }}">{{ $class->nom_classe }}</option>
                        @endforeach
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Timetable Card -->
    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-bordered mb-0 timetable-custom">
                    <thead class="table-light">
                        <tr>
                            <th class="text-center align-middle" style="width: 150px;">
                                <i class="bi bi-clock me-2"></i>{{ __('app.horaire') }}
                            </th>
                            <th class="text-center">
                                <div class="d-flex flex-column align-items-center">
                                    <i class="bi bi-calendar3 mb-1" style="font-size: 1.2rem;"></i>
                                    <span>{{ __('app.lundi') }}</span>
                                </div>
                            </th>
                            <th class="text-center">
                                <div class="d-flex flex-column align-items-center">
                                    <i class="bi bi-calendar3 mb-1" style="font-size: 1.2rem;"></i>
                                    <span>{{ __('app.mardi') }}</span>
                                </div>
                            </th>
                            <th class="text-center">
                                <div class="d-flex flex-column align-items-center">
                                    <i class="bi bi-calendar3 mb-1" style="font-size: 1.2rem;"></i>
                                    <span>{{ __('app.mercredi') }}</span>
                                </div>
                            </th>
                            <th class="text-center">
                                <div class="d-flex flex-column align-items-center">
                                    <i class="bi bi-calendar3 mb-1" style="font-size: 1.2rem;"></i>
                                    <span>{{ __('app.jeudi') }}</span>
                                </div>
                            </th>
                            <th class="text-center">
                                <div class="d-flex flex-column align-items-center">
                                    <i class="bi bi-calendar3 mb-1" style="font-size: 1.2rem;"></i>
                                    <span>{{ __('app.vendredi') }}</span>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="tbodyEmploi">
                        <!-- Content will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

@push('styles')
<style>
.timetable-custom {
    border-collapse: separate;
    border-spacing: 0;
}

.timetable-custom thead th {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    font-weight: 600;
    padding: 1rem;
    border: none;
}

.timetable-custom tbody td {
    padding: 1.25rem;
    vertical-align: middle;
    transition: all 0.3s ease;
}

.timetable-custom tbody td:first-child {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #495057;
}

.timetable-custom tbody td:not(:first-child):hover {
    background-color: #f0f4ff;
    transform: scale(1.02);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.timetable-custom tbody tr:nth-child(even) td:first-child {
    background-color: #e9ecef;
}

.course-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.course-link {
    display: inline-block;
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
    width: 100%;
}

.course-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
    color: white;
}

.empty-cell {
    color: #adb5bd;
    font-style: italic;
    font-size: 0.9rem;
}
</style>
@endpush

@push('scripts')
<script>
        const timetableData = {
            classe1: `
                <tr>
                    <td>{{ $debut08 && $fine11 ? date('H:i', strtotime($debut08->date_debut)) . ' - ' . date('H:i', strtotime($fine11->date_fin)) : '08:00 - 11:00' }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo1AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>

                <tr>
                    <td>{{ $debut1115 && $fine12 ? date('H:i', strtotime($debut1115->date_debut)) . ' - ' . date('H:i', strtotime($fine12->date_fin)) : '11:15 - 12:00' }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo1AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe2: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine11->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo2AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>

                <tr>
                    <td>{{ date('H:i', strtotime($debut1115->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo2AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe3: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine11->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo3AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>

                <tr>
                    <td>{{ date('H:i', strtotime($debut1115->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo3AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe4: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine11->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo4AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>

                <tr>
                    <td>{{ date('H:i', strtotime($debut1115->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo4AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe5: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine11->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo5AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>

                <tr>
                    <td>{{ date('H:i', strtotime($debut1115->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo5AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe6: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine11->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo6AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>

                <tr>
                    <td>{{ date('H:i', strtotime($debut1115->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo6AF as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,

            classe7: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo1AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo1AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo1AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,

            classe8: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo2AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo2AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo2AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,

            classe9: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo3AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo3AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo3AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,

            classe10: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo4AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo4AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo4AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,

            classe11: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo5AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo5AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo5AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,

            classe12: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo6AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo6AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo6AS as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe13: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo7ASD as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo7ASD as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo7ASD as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
            classe14: `
                <tr>
                    <td>{{ date('H:i', strtotime($debut08->date_debut)) }} - {{ date('H:i', strtotime($fine10->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($debutinfo7ASC as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut10->date_debut)) }} - {{ date('H:i', strtotime($fine12->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($milieuinfo7ASC as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>
                <tr>
                    <td>{{ date('H:i', strtotime($debut12->date_debut)) }} - {{ date('H:i', strtotime($fine14->date_fin)) }}</td>
                    @foreach ($joursSemaine as $jour)
                        @php
                            $matiereFound = false;
                        @endphp
                        @foreach ($fineinfo7ASC as $item)
                            @if ($item->jour === $jour)
                                <td><a href="{{ url('/cour/' . $item->id_cours . '/edit') }}">{{ $item->matiere }}</a></td>
                                @php
                                    $matiereFound = true;
                                    break;
                                @endphp
                            @endif
                        @endforeach
                        @if (!$matiereFound)
                            <td></td>
                        @endif
                    @endforeach
                </tr>`,
        };

        // Function to format course cell
        function formatCourseCell(content) {
            if (!content || content.trim() === '') {
                return '<span class="empty-cell">—</span>';
            }
            return `<div class="course-cell">${content}</div>`;
        }

        // Function to update the timetable based on the selected class
        function updateTimetable(classValue) {
            const timetable = document.querySelector(".tbodyEmploi");
            const timetableContent = timetableData[classValue];
            
            if (timetableContent) {
                // Process the content to add styling
                const processedContent = timetableContent.replace(
                    /<a href="([^"]+)">([^<]+)<\/a>/g,
                    '<a href="$1" class="course-link">$2</a>'
                );
                timetable.innerHTML = processedContent;
                
                // Style empty cells
                const cells = timetable.querySelectorAll('td:not(:first-child)');
                cells.forEach(cell => {
                    if (cell.textContent.trim() === '') {
                        cell.innerHTML = '<span class="empty-cell">—</span>';
                        cell.style.textAlign = 'center';
                    } else {
                        cell.style.textAlign = 'center';
                    }
                });
            } else {
                timetable.innerHTML = '<tr><td colspan="6" class="text-center py-5"><span class="text-muted">{{ __("app.aucun_cours_trouve") }}</span></td></tr>';
            }
        }

        // Listen for changes in the class select and update the timetable
        const classSelect = document.getElementById("classSelect");
        classSelect.addEventListener("change", () => {
            const selectedClass = classSelect.value;
            updateTimetable(selectedClass);
        });

        // Initial update to set the timetable based on the default selected class
        updateTimetable(classSelect.value);
    </script>
@endpush
@endsection
